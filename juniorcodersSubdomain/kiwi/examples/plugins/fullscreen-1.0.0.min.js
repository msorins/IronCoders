Kiwi.Plugins.Fullscreen={name:"Fullscreen",version:"1.0.0",minimumKiwiVersion:"1.1.0"},Kiwi.PluginManager.register(Kiwi.Plugins.Fullscreen),Kiwi.Plugins.Fullscreen.create=function(a){return a.fullscreen=new Kiwi.Plugins.Fullscreen.Main(a),a.fullscreen},Kiwi.Plugins.Fullscreen.Main=function(a){this.game=a,this.supported=!1,this._requestFullscreen=null,this._cancelFullscreen=null,this._updateScale=!1,this.onEnter=new Kiwi.Signal,this.onLeave=new Kiwi.Signal},Object.defineProperty(Kiwi.Plugins.Fullscreen.Main.prototype,"isFullscreen",{get:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(Kiwi.Plugins.Fullscreen.Main.prototype,"width",{get:function(){return window.innerWidth},enumerable:!0,configurable:!0}),Object.defineProperty(Kiwi.Plugins.Fullscreen.Main.prototype,"height",{get:function(){return window.innerHeight},enumerable:!0,configurable:!0}),Kiwi.Plugins.Fullscreen.Main.prototype.boot=function(){if(this.container=this.game.stage.container,this.targetElement=this.container,this.game.deviceTargetOption===Kiwi.TARGET_COCOON)return void(this.supported=!1);this.checkSupport();var a=this;document.addEventListener("webkitfullscreenchange",function(b){return a._onChange(b)},!1),document.addEventListener("mozfullscreenchange",function(b){return a._onChange(b)},!1),document.addEventListener("MSFullscreenChange",function(b){return a._onChange(b)},!1),document.addEventListener("fullscreenchange",function(b){return a._onChange(b)},!1),this.game.stage.onResize.add(this._checkPositionChanges,this),this.game.stage.onWindowResize.add(this._checkPositionChanges,this)},Kiwi.Plugins.Fullscreen.Main.prototype.launchFullscreen=function(){this.supported&&(this.fullscreenKeyboard?this.targetElement[this._requestFullscreen](Element.ALLOW_KEYBOARD_INPUT):this.targetElement[this._requestFullscreen]())},Kiwi.Plugins.Fullscreen.Main.prototype.exitFullscreen=function(){this.isFullscreen&&this.supported&&document[this._cancelFullscreen]()},Kiwi.Plugins.Fullscreen.Main.prototype.toggleFullscreen=function(){this.isFullscreen?this.exitFullscreen():this.launchFullscreen()},Kiwi.Plugins.Fullscreen.Main.prototype._onChange=function(){this.isFullscreen?(this._recalculateStyles(),this.onEnter.dispatch()):(this._removeStyles(),this.onLeave.dispatch()),this._updateScale=!0},Kiwi.Plugins.Fullscreen.Main.prototype._checkPositionChanges=function(){this.isFullscreen&&this._recalculateStyles()},Kiwi.Plugins.Fullscreen.Main.prototype._recalculateStyles=function(){if(this.targetElement===this.game.stage.container&&(this.targetElement.style.margin="0 auto",this.game.stage.scaleType===Kiwi.Stage.SCALE_FIT)){var a=parseInt(this.targetElement.style.height);a>this.height&&(this.targetElement.style.maxHeight=this.height+"px",this.targetElement.style.minWidth=String(this.game.stage.width*(this.height/this.game.stage.height))+"px",this._updateStageScale())}},Kiwi.Plugins.Fullscreen.Main.prototype._updateStageScale=function(){this.game.stage.offset=this.game.stage.getOffsetPoint(this.container),this.game.stage._scale.x=this.game.stage._width/this.container.clientWidth,this.game.stage._scale.y=this.game.stage._height/this.container.clientHeight},Kiwi.Plugins.Fullscreen.Main.prototype._removeStyles=function(){this.targetElement.style.maxHeight="",this.targetElement.style.margin=""},Kiwi.Plugins.Fullscreen.Main.prototype.update=function(){this._updateScale&&(this.game.stage._calculateContainerScale(),this._updateScale=!1)},Kiwi.Plugins.Fullscreen.Main.prototype.checkSupport=function(){for(var a=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","msRequestFullscreen","msRequestFullScreen","mozRequestFullScreen","mozRequestFullscreen"],b=0;b<a.length;b++)if(this.container[a[b]]){this.supported=!0,this._requestFullscreen=a[b];break}var c=["cancelFullScreen","exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","msCancelFullScreen","msExitFullscreen","mozCancelFullScreen","mozExitFullscreen"];if(this.supported)for(var b=0;b<c.length;b++)if(document[c[b]]){this._cancelFullscreen=c[b];break}window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(this.fullscreenKeyboard=!0)};